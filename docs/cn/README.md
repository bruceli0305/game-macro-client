# Game Macro 开发手册

Game Macro 自动化系统的全面技术文档，提供每个模块的架构、API 和使用方法的详细信息。

[English Version](../README.md) | [中文版本](README.md)

📖 **[用户使用手册](../useDocs/index.md)** - 专为普通用户设计的简明使用指南

## 概述

Game Macro 系统是一个基于 AutoHotkey v2 构建的复杂自动化框架，专为游戏自动化设计，具有像素检测、技能施放、增益管理和基于规则的自动化功能。

## 模块文档

### 核心模块

#### [核心模块](core/README.md)
- 全局应用状态管理
- 配置文件处理
- 默认配置文件和设置管理
- 应用程序生命周期控制

#### [运行时模块](runtime/README.md)
- 应用程序生命周期管理
- 线程管理系统
- 性能监控和优化
- 热键绑定和管理

#### [工具模块](util/README.md)
- 通用工具函数
- 对象操作工具
- ID 生成系统
- 常用辅助函数

### 引擎模块

#### [像素引擎](engines/pixel/README.md)
- 高性能像素检测
- 颜色管理系统
- 帧级缓存
- ROI（感兴趣区域）优化

#### [DXGI 引擎](engines/dup/README.md)
- 硬件加速屏幕捕获
- DirectX 图形基础设施集成
- 多显示器支持
- 动态 FPS 调整

#### [施法引擎](engines/cast/README.md)
- 技能施放自动化
- 施法条检测
- 技能状态跟踪
- 冷却时间管理

#### [增益引擎](engines/buff/README.md)
- 增益持续时间跟踪
- 增益状态检测
- 基于优先级的增益管理
- 自动增益续期

#### [规则引擎](engines/rules/README.md)
- 基于规则的自动化系统
- 条件评估引擎
- 动作执行框架
- 优先级和时序管理

#### [循环引擎](engines/rotation/README.md)
- 技能循环管理
- 基于阶段的执行
- 黑卫保护机制
- 开场序列处理

### 基础设施模块

#### [存储模块](storage/README.md)
- 配置文件管理系统
- 配置持久化
- 导出功能
- 文件系统操作

#### [日志模块](logging/README.md)
- 全面的日志系统
- 多接收器支持（文件、内存、管道）
- 日志轮转和管理
- 性能监控

#### [国际化模块](i18n/README.md)
- 多语言支持
- 资源文件管理
- 动态语言切换
- 翻译系统

#### [UI 框架](ui/README.md)
- 用户界面组件
- 基于页面的导航系统
- 模态对话框管理
- 响应式布局设计

#### [工作线程模块](workers/README.md)
- 后台任务管理
- 工作线程池
- 异步操作支持
- 资源管理

#### [原生库](lib/README.md)
- C++ 原生实现
- DXGI 复制功能
- 性能关键操作
- 硬件加速

## 系统架构

### 高层概览

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│    UI 层        │◄──►│  核心服务层     │◄──►│   引擎层        │
│                 │    │                 │    │                 │
│ • 页面          │    │ • 配置管理      │    │ • 像素检测      │
│ • 对话框        │    │ • 状态管理      │    │ • 技能施放      │
│ • 导航          │    │ • 日志记录      │    │ • 增益跟踪      │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         ▼                       ▼                       ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│  存储层         │    │  运行时层       │    │  原生层         │
│                 │    │                 │    │                 │
│ • 配置文件管理  │    │ • 线程池        │    │ • DXGI 捕获     │
│ • 文件 I/O      │    │ • 热键管理      │    │ • 性能优化      │
│ • 导出系统      │    │ • 轮询          │    │ • 优化          │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

### 数据流

1. **用户交互** → UI 层 → 核心服务层
2. **配置** → 存储层 → 所有模块
3. **自动化** → 引擎层 → 原生层
4. **监控** → 运行时层 → 日志系统

## 快速入门

### 先决条件
- AutoHotkey v2.0 或更高版本
- Windows 10/11 操作系统
- DirectX 兼容显卡
- 管理员权限（某些功能需要）

### 开发环境设置
1. 克隆代码库
2. 查看模块文档
3. 设置开发环境
4. 配置应用程序设置
5. 使用示例配置文件进行测试

### 模块集成
每个模块都设计为独立的开发和测试：
- 清晰的 API 边界
- 定义良好的接口
- 全面的错误处理
- 性能监控

## API 参考

### 核心 API
- **配置管理**: AppConfig_* 函数
- **状态管理**: Core_* 函数
- **日志记录**: Logger_* 函数
- **国际化**: Lang_* 函数

### 引擎 API
- **像素检测**: Pixel_* 函数
- **屏幕捕获**: Dup_* 函数
- **技能施放**: Cast_* 函数
- **增益管理**: Buff_* 函数
- **规则执行**: Rule_* 函数

### 工具 API
- **对象操作**: Obj_* 函数
- **ID 生成**: IdGen_* 函数
- **通用工具**: Utils_* 函数

## 配置指南

### 应用程序配置
位于 `Config/AppConfig.ini`:
```ini
[General]
Language=zh-CN
Version=2.0.0

[Logging]
Level=INFO
RotateSizeMB=10
RotateKeep=5
```

### 配置文件配置
配置文件存储在 `Profiles/` 目录：
- 技能配置
- 规则定义
- 增益设置
- 循环序列

## 性能优化

### 关键优化领域
1. **像素检测**: 使用 ROI 和帧缓存
2. **屏幕捕获**: 利用 DXGI 硬件加速
3. **规则评估**: 优化条件评估顺序
4. **内存管理**: 高效资源利用
5. **线程管理**: 适当的工作线程分配

### 监控工具
- 内置性能计数器
- 详细日志系统
- 实时状态监控
- 错误跟踪和报告

## 故障排除

### 常见问题
1. **DXGI 初始化失败**: 检查显卡驱动和权限
2. **像素检测问题**: 验证颜色容差和坐标
3. **规则执行问题**: 检查条件逻辑和优先级
4. **性能下降**: 监控系统资源并优化设置

### 调试技巧
- 启用调试日志
- 使用诊断工具
- 查看性能指标
- 使用简化配置进行测试

## 贡献指南

### 开发指南
1. 遵循既定的编码标准
2. 维护全面的文档
3. 为新功能包含单元测试
4. 提交前进行彻底测试

### 模块开发
添加新模块时：
1. 创建清晰的 API 文档
2. 实现适当的错误处理
3. 包含性能监控
4. 遵循既定的架构模式

## 许可证和归属

本文档是 Game Macro 系统的一部分。请参阅项目的许可证文件以了解使用和分发条款。

## 支持

对于技术支持和开发问题：
- 查看模块特定文档
- 检查故障排除部分
- 检查示例实现
- 查看 API 参考

---

*本文档作为 Game Macro 开发过程的一部分自动生成和维护。*

[返回英文版本](../README.md)